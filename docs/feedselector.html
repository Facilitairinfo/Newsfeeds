<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Feedconfig Generator</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 20px; }
    input[type="text"] { width: 520px; padding: 6px; margin-bottom: 10px; }
    button { padding: 6px 12px; font-size:14px; }
    pre { background:#f6f8fa; padding:8px; border-radius:6px; overflow:auto; }
  </style>
</head>
<body>
  <h1>ðŸ”§ Feedconfig Generator</h1>

  <label>Feednaam:<br>
    <input type="text" id="feedName" placeholder="custom-feed" />
  </label><br>

  <h2>ðŸ“¦ YAML-config</h2>
  <pre id="yamlOut">Wacht op selectie...</pre>

  <script>
    function decodeHash() {
      const hash = location.hash.slice(1);
      if (!hash) return null;
      try {
        const json = decodeURIComponent(escape(atob(hash)));
        return JSON.parse(json);
      } catch (err) {
        console.warn("Kon selectie niet decoderen:", err);
        return null;
      }
    }

    function renderYAML(data) {
      const sel = data.selections || {};
      const sourceUrl = data.location || "";
      const feedName = document.getElementById("feedName").value.trim() || "custom-feed";

      const yaml = [
        `id: ${feedName}`,
        `source_url: ${sourceUrl}`,
        `render: true`,
        `scroll_to_bottom: true`,
        `wait_for_selector: ${sel.title || ""}`,
        `wait_for_count: 5`,
        ``,
        `selectors:`,
        `  title: ${sel.title || ""}`,
        sel.date ? `  date: ${sel.date}` : `  # date: niet gekozen`,
        sel.summary ? `  summary: ${sel.summary}` : `  # summary: niet gekozen`,
        sel.image ? `  image: ${sel.image}` : `  # image: niet gekozen`,
        ``,
        `output:`,
        `  feed_file: docs/${feedName}.xml`,
        `  site_name: ${sourceUrl ? new URL(sourceUrl).host : ""}`,
        `  site_url: ${sourceUrl}`,
        ``,
        `limits:`,
        `  max_items: 20`,
        `  dedupe_on: url`
      ].join("\n");

      document.getElementById("yamlOut").textContent = yaml;
    }

    const data = decodeHash();
    if (data) renderYAML(data);

    document.getElementById("feedName").addEventListener("input", () => {
      if (data) renderYAML(data);
    });
  </script>
</body>
</html>
